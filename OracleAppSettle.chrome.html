<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Call OracleAppSettle.ashx (SD)</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
</head>
<body>
    <h3>更新輪候狀態，由輪候中變為已上樓</h3>
    <h3>Call OracleAppSettle.ashx (SD)</h3>    
    <form id="myForm" method="post" action="http://web2012-pro-01/UB/Services/OracleAppSettle.ashx" enctype="application/x-www-form-urlencoded; charset=UTF-8>
        <div>
            <label for="ctrnum">合約編號</label>
            <input type="number" id="ctrnum" name="ctrnum" maxlength="13" autofocus required>
        </div>
        <div>
            <button type="submit">遞交</button>
        </div>
    </form>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Get the URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            
            // Retrieve specific parameter values
            const ctrnum = urlParams.get('ctrnum');            

            // Display the parameter values
            const outputElement = document.getElementById('ctrnum');
            outputElement.value = ctrnum;

            if (ctrnum) {
                // Automatically submit the form, ie: 
                // http://127.0.0.1:5500/OracleAppSettle.html?ctrnum=6120240565001
                console.log('ctrnum=', ctrnum);
                document.getElementById("myForm").submit();     
                //window.close();
            } else {
                console.log("ctrnum not specified.")
            }

        });
    </script>
    <!--    
        <script language="JavaScript">
        try{
            var content = document.getElementById("ctrnum").innerText;
            var ctrnum = content.replace("合約編號: ","");
            var request = new XMLHttpRequest();
            request.open("POST", "http://web2012-pro-01/UB/Services/OracleAppSettle.ashx", true);
            request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8");
            request.send("ctrnum="+ctrnum);
        }catch (ex) {
            console.log(ex);
        }
        </script>    
    -->
</body>
</html>